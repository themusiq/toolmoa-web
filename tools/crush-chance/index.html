<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>썸/연애 확률 계산기 | Toolmoa.kr</title>
  <meta property="og:title" content="썸/연애 확률 계산기 | Toolmoa.kr">
  <meta property="og:description" content="가벼운 6문항으로 오늘의 썸/연애 성사 확률을 계산해 드립니다.">
  <meta property="og:type" content="website">
  <link rel="stylesheet" href="/assets/css/base.css">
  <link rel="stylesheet" href="/assets/css/tool-info.css">
  <script defer src="/assets/js/ui-kit.js"></script>
  <style>
    .q {margin:8px 0}
    .q label{display:block;margin-bottom:4px;font-weight:600}
    .q .row{gap:8px;flex-wrap:wrap}
    .chip{padding:8px 10px;border:1px solid #ddd;border-radius:8px;cursor:pointer}
    input[type="radio"],input[type="checkbox"]{accent-color:#6c63ff}
  </style>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8660767493820036" crossorigin="anonymous"></script>

</head>
<body>
  <script src="/assets/js/theme.js"></script>
<script src="/assets/js/auto-wire.js"></script>
<header class="site-header">
  <div class="brand"><span class="emoji">🧰</span> Toolmoa.kr</div>
</header>

<main class="container">
  <section class="hero">
    <div class="h-title">💗 썸/연애 확률 계산기</div>
    <p class="muted">가벼운 6문항으로 오늘의 <b>성사 확률</b>과 <b>추천 액션</b>을 알려드려요.</p>
  </section>

  <!-- 입력 -->
  <section class="card" id="inputCard">
    <div class="h-sub">📝 체크</div>

    <div class="q">
      <label>1) 오늘 서로 연락을 주고 받았나요?</label>
      <div class="row">
        <label class="chip"><input type="radio" name="q1" value="10"> 네</label>
        <label class="chip"><input type="radio" name="q1" value="0"> 아직</label>
      </div>
    </div>

    <div class="q">
      <label>2) 최근 3일간 답장 속도는?</label>
      <div class="row">
        <label class="chip"><input type="radio" name="q2" value="12"> 즉시/빠름</label>
        <label class="chip"><input type="radio" name="q2" value="6"> 보통</label>
        <label class="chip"><input type="radio" name="q2" value="0"> 느림/뜸함</label>
      </div>
    </div>

    <div class="q">
      <label>3) 최근 1주 내 만남/영상통화가 있었나요?</label>
      <div class="row">
        <label class="chip"><input type="radio" name="q3" value="15"> 네</label>
        <label class="chip"><input type="radio" name="q3" value="0"> 아니오</label>
      </div>
    </div>

    <div class="q">
      <label>4) 대화 주제에 개인적인 이야기(가족·취향 등)가 포함되나요?</label>
      <div class="row">
        <label class="chip"><input type="radio" name="q4" value="10"> 네</label>
        <label class="chip"><input type="radio" name="q4" value="2"> 가끔</label>
        <label class="chip"><input type="radio" name="q4" value="0"> 거의 없음</label>
      </div>
    </div>

    <div class="q">
      <label>5) 오늘 보낼 수 있는 호감 신호 (복수 선택)</label>
      <div class="row">
        <label class="chip"><input type="checkbox" value="6"> 안부 한 줄</label>
        <label class="chip"><input type="checkbox" value="6"> 공통 취향 공유</label>
        <label class="chip"><input type="checkbox" value="6"> 주말 커피챗 제안</label>
      </div>
    </div>

    <div class="q">
      <label>6) 내 컨디션은?</label>
      <div class="row">
        <label class="chip"><input type="radio" name="q6" value="8"> 최고</label>
        <label class="chip"><input type="radio" name="q6" value="4"> 보통</label>
        <label class="chip"><input type="radio" name="q6" value="0"> 저조</label>
      </div>
    </div>

    <div class="row" style="margin-top:8px">
      <button id="checkBtn" class="btn-primary btn-banner" type="button">확인</button>
    </div>
  </section>

  <!-- 결과 -->
  <div id="ad-coupang" style="margin-top:16px"></div>

  <section id="resultCard" class="card hidden">
    <div class="h-sub">🎯 오늘의 확률</div>
    <div class="result-highlight" id="summary"></div>
    <ul class="bullet" id="tips" style="margin-top:8px"></ul>

    <div class="h-sub" style="margin-top:12px">🔍 더 알아보기</div>
    <div id="links" class="link-banner-row"></div>

    <div class="cta-row" style="margin-top:16px">
      <button id="btnShare" class="btn btn-banner" type="button" hidden>공유하기</button>
      <button id="resetBtn" class="btn-primary btn-banner" type="button">다시 하기</button>
      <a class="btn-primary btn-banner" href="/">홈으로</a>
    </div>
  </section>

  <section id="tool-info"></section>
</main>

<footer class="site-footer">
  <div class="footer-inner">
    <div class="footer-logo">🛠 Toolmoa.kr</div>
    <p class="footer-copy">© <span id="cpyYear"></span> Toolmoa.kr. All rights reserved.</p>
  </div>
</footer>
<script>document.getElementById('cpyYear').textContent=new Date().getFullYear()</script>

<script type="module">
  import { scrollToEl } from '/assets/js/toolmoa-common.js'
  import { mountToolInfo } from '/assets/js/tool-info.js'

  const checkBtn = document.getElementById('checkBtn')
  const btnShare = document.getElementById('btnShare')
  const resetBtn = document.getElementById('resetBtn')
  const resultCard = document.getElementById('resultCard')
  const summary = document.getElementById('summary')
  const tips = document.getElementById('tips')
  const links = document.getElementById('links')

  function valSum(name){ const n=document.querySelector(`input[name="${name}"]:checked`); return n?Number(n.value):0 }
  function chkSum(){ return [...document.querySelectorAll('input[type="checkbox"]:checked')].reduce((t,c)=>t+Number(c.value),0) }

  function run(){
    // 총 0~? → 0~100으로 캡
    let score = valSum('q1')+valSum('q2')+valSum('q3')+valSum('q4')+chkSum()+valSum('q6')
    if(score===0){ alert('최소 한 항목 이상 선택해 주세요.'); return }
    if(score>100) score=100

    const comment = score>=86?'타이밍 잡아도 좋아요!'
      :score>=70?'분위기 좋음—대화 빈도만 살짝 ↑'
      :score>=50?'기대 여지 충분—공통 관심사 키우기'
      :score>=30?'라포 쌓는 날—가벼운 안부부터'
      :'관찰 모드—무리한 접근은 보류'

    summary.innerHTML = `
      <div class="big-num">${score}%</div>
      <div class="note">${comment}</div>
    `
    tips.innerHTML = `
      <li>오늘의 추천 액션: <b>${score>=70?'주말 약속 제안':'안부 한 줄 + 공통 취향 공유'}</b></li>
      <li>대화 소재: 최근 본 콘텐츠/맛집/여행</li>
    `
    links.innerHTML = `
      <a class="btn-info" href="https://m.search.naver.com/search.naver?query=${encodeURIComponent('연애 호감 신호')}" target="_blank" rel="noopener">호감 신호 더보기</a>
    `
    resultCard.classList.remove('hidden')
    btnShare.hidden = false
    scrollToEl(resultCard)

    // 공유 상태 저장
    history.replaceState({}, '', shareUrl(score))
  }

  function shareUrl(score){
    const u = new URL(location.href)
    u.searchParams.set('mode','share')
    u.searchParams.set('s', score)
    return u.toString()
  }
  async function share(){
    const url = new URL(location.href)
    const s = summary.textContent.match(/\d+%/)?.[0]?.replace('%','') || '0'
    url.searchParams.set('mode','share')
    url.searchParams.set('s', s)
    try{
      if(navigator.share) await navigator.share({title:'썸/연애 확률', text:`오늘 확률 ${s}%`, url:url.toString()})
      else { await navigator.clipboard.writeText(url.toString()); alert('공유 링크를 복사했어요.') }
    }catch(e){}
  }

  // 공유 링크 랜딩
  ;(()=>{
    const sp=new URLSearchParams(location.search)
    if(sp.get('mode')!=='share') return
    const s=Number(sp.get('s')||0)
    if(s>0){
      summary.innerHTML = `<div class="big-num">${s}%</div><div class="note">공유된 결과</div>`
      tips.innerHTML = `<li>친구의 오늘 결과입니다. 참고만 해 주세요!</li>`
      resultCard.classList.remove('hidden')
      btnShare.hidden=false
    }
  })()

  checkBtn.addEventListener('click', run)
  btnShare.addEventListener('click', share)
  resetBtn.addEventListener('click', ()=>{ location.href = location.pathname })

  mountToolInfo('crush-chance')
</script>

<script type="module">
  import { renderCoupangBanner } from '/assets/js/ads-coupang.js';
  const slot = document.getElementById('ad-coupang');
  const tryAd = () => { 
    if(!slot || slot.dataset.loaded) return;
    renderCoupangBanner('#ad-coupang', { id: '909422', trackingCode: 'AF3778137', width:680, height:140 });
    slot.dataset.loaded = '1';
  };
  const rc = document.getElementById('resultCard');
  if (rc) {
    const obs = new MutationObserver(() => {
      if (!rc.classList.contains('hidden')) tryAd();
    });
    obs.observe(rc, { attributes:true, attributeFilter:['class'] });
  } else {
    // if there is no resultCard, just render immediately
    tryAd();
  }
</script>
  <script src="/assets/js/ui-kit.js">
</script>


  
</body>
</html>
