<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>ë³„ìë¦¬ ìš´ì„¸ | Toolmoa.kr</title>

  <meta property="og:title" content="ë³„ìë¦¬ ìš´ì„¸ | Toolmoa.kr">
  <meta property="og:description" content="ìƒì¼ì„ ì…ë ¥í•˜ë©´ ë³„ìë¦¬ë¥¼ ê³„ì‚°í•˜ê³ , 3ìš”ì†Œ ìŠ¤í”„ë ˆë“œÂ·ì‹œê°„ëŒ€ ìš´ì„¸Â·60ì´ˆ ë£¨í‹´ì„ ì¹´ë“œë¡œ ë³´ì—¬ë“œë¦½ë‹ˆë‹¤.">
  <meta property="og:type" content="website">

  <link rel="stylesheet" href="/assets/css/base.css">
  <link rel="stylesheet" href="/assets/css/tool-info.css">
  <script defer src="/assets/js/ui-kit.js"></script>
  <style>#spread3 li+li{margin-top:2px}</style>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8660767493820036" crossorigin="anonymous"></script>

</head>
<body>
  <script src="/assets/js/theme.js"></script>
<script src="/assets/js/auto-wire.js"></script>
<header>
  <a href="/">ğŸ§° Toolmoa.kr</a>
</header>

<main class="container">
  <section class="hero" id="hero">
    <div class="h-title">ğŸ”® ë³„ìë¦¬ ìš´ì„¸</div>
    <p class="muted">ìƒì¼ì„ ì…ë ¥í•˜ë©´ ë³„ìë¦¬ë¥¼ ê³„ì‚°í•˜ê³ , <b>3ìš”ì†Œ ìŠ¤í”„ë ˆë“œ</b>Â·<b>ì‹œê°„ëŒ€ ìš´ì„¸</b>Â·<b>60ì´ˆ ë£¨í‹´</b>ê¹Œì§€ ì¹´ë“œ í˜•ì‹ìœ¼ë¡œ ë³´ì—¬ë“œë ¤ìš”.</p>
  </section>

  <!-- ì…ë ¥ -->
  <section class="card" id="inputCard">
    <div class="h-sub">ğŸ—“ï¸ ìƒì¼ ì…ë ¥</div>
    <div class="row" style="margin-top:8px">
      <input id="birth" type="date" class="input" placeholder="ì—°ë„-ì›”-ì¼">
      <button id="checkBtn" class="btn-primary btn-banner" type="button">í™•ì¸</button>
    </div>
  </section>

  <!-- ê²°ê³¼ -->
  <div id="ad-coupang" style="margin-top:16px"></div>

  <section id="resultCard" class="card hidden">
    <div class="h-sub">ğŸ“£ ì˜¤ëŠ˜ì˜ ìš´ì„¸</div>
    <div class="result-highlight" id="resultSummary"></div>

    <div id="miniCats" class="bullet" style="margin-top:8px"></div>

    <div class="card" style="margin-top:12px">
      <div class="h-sub">ğŸƒ ì˜¤ëŠ˜ì˜ 3ìš”ì†Œ ìŠ¤í”„ë ˆë“œ</div>
      <ul id="spread3" class="bullet"></ul>
      <div class="cta-row" style="margin-top:8px">
        <button id="rerollLucky" class="btn btn-banner" type="button">í–‰ìš´ ì¹´ë“œë§Œ ë‹¤ì‹œ ë½‘ê¸°</button>
      </div>
    </div>

    <div class="card" style="margin-top:12px">
      <div class="h-sub">â° ì‹œê°„ëŒ€ ìš´ì„¸</div>
      <ul id="dayPhases" class="bullet"></ul>
    </div>

    <div class="card" style="margin-top:12px">
      <div class="h-sub">âœ… ì˜¤ëŠ˜ì˜ 60ì´ˆ ë£¨í‹´</div>
      <div id="oneMin" class="note"></div>
    </div>

    <div class="h-sub" style="margin-top:12px">ğŸ” ë” ì•Œì•„ë³´ê¸°</div>
    <div class="link-banner-row" id="linkRow"></div>

    <!-- ê´‘ê³  (ì„ íƒ) -->
    <div id="adsenseSlot" style="margin-top:10px; text-align:center;"></div>

    <div class="cta-row" style="margin-top:16px">
      <button id="btnShare" class="btn btn-banner" type="button" hidden>ê³µìœ í•˜ê¸°</button>
      <button id="resetBtn" class="btn-primary btn-banner" type="button">ë‹¤ì‹œ í•˜ê¸°</button>
      <a class="btn-primary btn-banner" href="/">í™ˆìœ¼ë¡œ</a>
    </div>
  </section>

  <!-- ì„¤ëª… ê°•í™” -->
  <section id="tool-info"></section>
</main>

<footer class="site-footer">
  <div class="footer-inner">
    <div class="footer-logo">ğŸ›  Toolmoa.kr</div>
    <p class="footer-copy">Â© <span id="cpyYear"></span> Toolmoa.kr. All rights reserved.</p>
  </div>
</footer>
<script>document.getElementById('cpyYear').textContent = new Date().getFullYear();</script>

<script type="module">
  import { scrollTop, scrollToEl } from '/assets/js/toolmoa-common.js';
  import { mountToolInfo } from '/assets/js/tool-info.js';

  // ===== ì—˜ë¦¬ë¨¼íŠ¸ =====
  const birthEl    = document.getElementById('birth');
  const checkBtn   = document.getElementById('checkBtn');
  const btnShare   = document.getElementById('btnShare');
  const resetBtn   = document.getElementById('resetBtn');
  const inputCard  = document.getElementById('inputCard');
  const resultCard = document.getElementById('resultCard');
  const resultSummary = document.getElementById('resultSummary');
  const miniCats   = document.getElementById('miniCats');
  const spread3    = document.getElementById('spread3');
  const dayPhases  = document.getElementById('dayPhases');
  const oneMin     = document.getElementById('oneMin');
  const linkRow    = document.getElementById('linkRow');

  // ===== ë³„ìë¦¬ ë°ì´í„° =====
  const ZS = [
    {name:'ë¬¼ë³‘ìë¦¬',start:'01-20',end:'02-18',trait:'ë…ì°½ì„±Â·ë„¤íŠ¸ì›Œí‚¹'},
    {name:'ë¬¼ê³ ê¸°ìë¦¬',start:'02-19',end:'03-20',trait:'ê³µê°Â·ìƒìƒë ¥'},
    {name:'ì–‘ìë¦¬',start:'03-21',end:'04-19',trait:'ì‹¤í–‰ë ¥Â·ë¦¬ë”ì‹­'},
    {name:'í™©ì†Œìë¦¬',start:'04-20',end:'05-20',trait:'ê¾¸ì¤€í•¨Â·ì•ˆì •'},
    {name:'ìŒë‘¥ì´ìë¦¬',start:'05-21',end:'06-21',trait:'ì†Œí†µÂ·í˜¸ê¸°ì‹¬'},
    {name:'ê²Œìë¦¬',start:'06-22',end:'07-22',trait:'ëŒë´„Â·ì§‘ì¤‘'},
    {name:'ì‚¬ììë¦¬',start:'07-23',end:'08-22',trait:'ìì‹ ê°Â·í‘œí˜„'},
    {name:'ì²˜ë…€ìë¦¬',start:'08-23',end:'09-23',trait:'ì •ëˆÂ·ë¶„ì„'},
    {name:'ì²œì¹­ìë¦¬',start:'09-24',end:'10-22',trait:'ê· í˜•Â·í˜‘ì—…'},
    {name:'ì „ê°ˆìë¦¬',start:'10-23',end:'11-22',trait:'ëª°ì…Â·í†µì°°'},
    {name:'ì‚¬ìˆ˜ìë¦¬',start:'11-23',end:'12-24',trait:'í™•ì¥Â·íƒí—˜'},
    {name:'ì—¼ì†Œìë¦¬',start:'12-25',end:'01-19',trait:'ì±…ì„Â·ì‹¤í–‰'}
  ];
  const toMD = d => d.toISOString().slice(5,10);
  const inRange = (md,s,e) => s>e ? (md>=s || md<=e) : (md>=s && md<=e);
  const findZ = d => ZS.find(z => inRange(toMD(d), z.start, z.end)) || ZS[0];

  // ìœ í‹¸(ì‹œë“œ ë‚œìˆ˜)
  const seedFrom = str => Array.from(str).reduce((a,c)=>(a*131+c.charCodeAt(0))>>>0,7);
  const prng = s => () => (s=(s*1664525+1013904223)>>>0)/2**32;
  const pick = (rng, arr) => arr[Math.floor(rng()*arr.length)];

  const LUCKY_COLORS=['ë¸”ë£¨','ê·¸ë¦°','ì˜ë¡œ','í¼í”Œ','ë ˆë“œ','í™”ì´íŠ¸','ë¸”ë™','ì˜¤ë Œì§€','ë¯¼íŠ¸','ë„¤ì´ë¹„'];
  const LUCKY_ITEMS=['í…€ë¸”ëŸ¬','ë…¸íŠ¸&íœ','í‚¤ë§','ë¨¸ê·¸ì»µ','ì´ì–´ë²„ë“œ','ì±…ê°ˆí”¼','ìŠ¤í‹°ì»¤','ìº”ë“¤','ì†ì„¸ì •ì œ','ì†ìˆ˜ê±´'];
  const LUCKY_NUMS=[3,4,5,6,7,8,9,11,12,13,17,21,24,27];
  const LUCKY_SLOTS=['ì˜¤ì „ 9~11ì‹œ','ì˜¤ì „ 11~12ì‹œ','ì˜¤í›„ 1~3ì‹œ','ì˜¤í›„ 3~5ì‹œ','ì˜¤í›„ 7~9ì‹œ'];

  const TPL = {
    total:z=>[
      `${z.name}ì˜ í•µì‹¬ì€ ${z.trait}. ì˜¤ëŠ˜ì€ ê·¸ ê°•ì ì´ ë¹›ë‚˜ëŠ” ë‚ .`,
      `ë‹¹ì‹ ì˜ í˜ì´ìŠ¤ê°€ ê³§ ë¦¬ë“¬. ${z.name}ë‹¤ìš´ ì„ íƒì´ ê¸°íšŒë¥¼ ë¶€ë¦…ë‹ˆë‹¤.`,
      `ì‘ê²Œ ì‹œì‘í•´ í¬ê²Œ ë§ˆë¬´ë¦¬. ${z.name}ì˜ ì§‘ì¤‘ë ¥ì´ ì„±ê³¼ë¥¼ ë§Œë“¤ì–´ìš”.`
    ],
    love:['ê°ì •ì€ ì†”ì§í•˜ê²Œ, í‘œí˜„ì€ ë¶€ë“œëŸ½ê²Œ.','ê°€ë²¼ìš´ ì¹­ì°¬ í•œ ì¤„ì´ ë¶„ìœ„ê¸°ë¥¼ ë°”ê¿‰ë‹ˆë‹¤.','ì—°ë½ ë¹ˆë„ë¥¼ ì˜¤ëŠ˜ë§Œ ì‚´ì§ ëŠ˜ë ¤ë³´ì„¸ìš”.'],
    money:['ì†Œë¹„ë³´ë‹¤ ì •ë¦¬. êµ¬ë…/ê²°ì œë¥¼ ì ê²€í•´ìš”.','ì‘ì€ ìˆ˜ìµ í¬ì¸íŠ¸ê°€ ëˆˆì— ë„ëŠ” ë‚ .','ì§€ì¶œì—” ë©”ëª¨â€”ë‚´ì¼ì˜ ì•„ì´ë””ì–´ê°€ ë©ë‹ˆë‹¤.'],
    health:['ì§§ì€ ìŠ¤íŠ¸ë ˆì¹­ 3ì„¸íŠ¸ê°€ ì»¨ë””ì…˜ì„ ì‚´ë ¤ìš”.','ì¹´í˜ì¸/ë‹¹ë¶„ì€ í‰ì†Œì˜ 80%ë§Œ.','10ë¶„ í–‡ë³• ì¬ê¸°â€”ë¦¬ë“¬ì„ ë§ì¶°ì¤˜ìš”.'],
    am:['ë©”ì‹œì§€Â·ë©”ì¼ ì •ë¦¬ì— ìš´ì´ ì‹¤ë ¤ìš”.','ì²« 1ì‹œê°„ì€ ë£¨í‹´ë§Œâ€”ë¦¬ë“¬ì´ ì¡í™ë‹ˆë‹¤.','ê°€ë²¼ìš´ ì‚°ì±… í›„ ì‹œì‘í•´ ë³´ì„¸ìš”.'],
    pm:['ì˜¤í›„ì—” ì •ë¦¬Â·ì •ëˆì´ íš¨ìœ¨ì„ ì˜¬ë¦½ë‹ˆë‹¤.','ì‚¬ëŒ ë§Œë‚¨ì— ë³µì´ ìˆì–´ìš”â€”ì§§ì€ ì»¤í”¼ì±— ì¶”ì²œ.','í‡´ê·¼ ì „ 15ë¶„ íšŒê³ ê°€ ë‚´ì¼ì„ ë°”ê¿”ìš”.'],
    action:['ì—°ë½ì„ ë¯¸ë£¬ í•œ ì‚¬ëŒì—ê²Œ â€œì•ˆë¶€ í•œ ì¤„â€ ë³´ë‚´ê¸°.','ì˜¤ëŠ˜ì˜ ìƒ‰ì´ ë³´ì´ëŠ” ë¬¼ê±´ í•˜ë‚˜ ë‘ê¸°.','ì•¨ë²”ì—ì„œ ì‚¬ì§„ 10ì¥ ì •ë¦¬.'],
    avoid:['ë¹„êµ/ë¹„ë‚œ ìŠ¤í¬ë¡¤ì€ ì˜¤ëŠ˜ë§Œ ì°¨ë‹¨.','ì¦‰í¥ì  í°ì§€ì¶œ, ë³´ë¥˜.','í•œ ë²ˆì— ëª¨ë“  ê±¸ ëë‚´ë ¤ëŠ” íƒœë„ëŠ” ê¸ˆë¬¼.']
  };

  let lastDob = '';

  function render(dob){
    const d = new Date(dob+'T00:00:00');
    const z = findZ(d);

    const dayKey = new Date().toISOString().slice(0,10);
    const rng = prng(seedFrom(dob+'|'+dayKey));

    // ì´ìš´
    const total = pick(rng, TPL.total(z));
    resultSummary.innerHTML = `
      <div class="kicker">ì˜¤ëŠ˜ì˜ ë³„ìë¦¬</div>
      <div class="big-num">${z.name}</div>
      <div class="note">${total}</div>
    `;

    // ë¯¸ë‹ˆ ì¹´í…Œê³ ë¦¬
    miniCats.innerHTML = `
      <li>â¤ï¸ ì—°ì• : ${pick(rng, TPL.love)}</li>
      <li>ğŸ’¼ ê¸ˆì „: ${pick(rng, TPL.money)}</li>
      <li>ğŸ§˜ ê±´ê°•: ${pick(rng, TPL.health)}</li>
    `;

    // 3ìš”ì†Œ ìŠ¤í”„ë ˆë“œ
    const rngSeed = seedFrom(dob+'|'+dayKey);
    spread3.dataset.seed = rngSeed;
    const luckyColor = pick(rng, LUCKY_COLORS);
    const luckyItem  = pick(rng, LUCKY_ITEMS);
    const luckyNum   = pick(rng, LUCKY_NUMS);
    const avoidTxt   = pick(rng, TPL.avoid);
    const actionTxt  = pick(rng, TPL.action);
    spread3.innerHTML = `
      <li>ğŸ <b>í–‰ìš´ ì•„ì´í…œ</b>: ${luckyItem}</li>
      <li>ğŸ¨ <b>í–‰ìš´ ì»¬ëŸ¬</b>: ${luckyColor} Â· <b>í–‰ìš´ ìˆ«ì</b>: ${luckyNum}</li>
      <li>ğŸš« <b>í”¼í•´ì•¼ í•  íŒ¨í„´</b>: ${avoidTxt}</li>
      <li>âœ… <b>í–‰ìš´ ì•¡ì…˜</b>: ${actionTxt}</li>
    `;

    dayPhases.innerHTML = `
      <li>AM: ${pick(rng, TPL.am)}</li>
      <li>PM: ${pick(rng, TPL.pm)}</li>
      <li>ğŸ¯ í–‰ìš´ íƒ€ì„: ${pick(rng, LUCKY_SLOTS)}</li>
    `;
    oneMin.textContent = `ì˜¤ëŠ˜ì˜ 60ì´ˆ ë£¨í‹´ â€” ${actionTxt}`;

    // ì™¸ë¶€ CTA
    const hv = `https://m.search.naver.com/search.naver?query=${encodeURIComponent(z.name+' ìš´ì„¸')}`;
    const lunar = `https://m.search.naver.com/search.naver?query=${encodeURIComponent(dob+' ìŒë ¥ ë³€í™˜')}`;
    const compat= `https://m.search.naver.com/search.naver?query=${encodeURIComponent(z.name+' ê¶í•© ì˜ ë§ëŠ” ë³„ìë¦¬')}`;
    linkRow.innerHTML = `
      <a class="btn-info" href="${hv}" target="_blank" rel="noopener">ì˜¤ëŠ˜ì˜ ${z.name} ìš´ì„¸ ë” ë³´ê¸°</a>
      <a class="btn-info" href="${lunar}" target="_blank" rel="noopener">ìŒë ¥ ìƒì¼ ë³´ëŸ¬ê°€ê¸°</a>
      <a class="btn-info" href="${compat}" target="_blank" rel="noopener">ì˜ ë§ëŠ” ë³„ìë¦¬ Top2</a>
    `;

    resultCard.classList.remove('hidden');
    btnShare.hidden = false;
    scrollToEl(resultCard);

    // ì¬ì¶”ì²¨
    document.getElementById('rerollLucky').onclick = ()=>{
      const r = prng((rngSeed|0) + Date.now()%100000);
      spread3.innerHTML = `
        <li>ğŸ <b>í–‰ìš´ ì•„ì´í…œ</b>: ${pick(r, LUCKY_ITEMS)}</li>
        <li>ğŸ¨ <b>í–‰ìš´ ì»¬ëŸ¬</b>: ${pick(r, LUCKY_COLORS)} Â· <b>í–‰ìš´ ìˆ«ì</b>: ${pick(r, LUCKY_NUMS)}</li>
        <li>ğŸš« <b>í”¼í•´ì•¼ í•  íŒ¨í„´</b>: ${pick(r, TPL.avoid)}</li>
        <li>âœ… <b>í–‰ìš´ ì•¡ì…˜</b>: ${pick(r, TPL.action)}</li>
      `;
    };
  }

  function shareUrl(){
    const origin = location.origin || (location.protocol + '//' + location.host);
    return `${origin}/tools/horoscope/?mode=share&dob=${encodeURIComponent(lastDob)}`;
  }
  async function share(){
    if(!lastDob) return;
    const url = shareUrl();
    try{
      if (navigator.share){
        await navigator.share({ title:'ë³„ìë¦¬ ìš´ì„¸ - Toolmoa.kr', text:'ì˜¤ëŠ˜ì˜ ë³„ìë¦¬ ìš´ì„¸ë¥¼ í™•ì¸í•´ ë³´ì„¸ìš”!', url });
      } else {
        await navigator.clipboard.writeText(url);
        alert('ê³µìœ  ë§í¬ë¥¼ ë³µì‚¬í–ˆì–´ìš”.');
      }
    }catch(e){}
  }

  function run(){
    if(!birthEl.value){ birthEl.focus(); return; }
    lastDob = birthEl.value;
    render(lastDob);
  }

  // ê³µìœ  ëª¨ë“œ
  const params = new URLSearchParams(location.search);
  const mode = params.get('mode');
  const dobParam = params.get('dob') || params.get('date');
  if (mode === 'share' && dobParam){
    inputCard.classList.add('hidden');
    lastDob = dobParam;
    render(lastDob);
  }

  // ì´ë²¤íŠ¸
  checkBtn.addEventListener('click', run);
  birthEl.addEventListener('keydown', e=>{ if(e.key==='Enter') run(); });
  btnShare.addEventListener('click', share);
  resetBtn.addEventListener('click', ()=>{
    birthEl.value='';
    resultCard.classList.add('hidden');
    resultSummary.innerHTML = '';
    miniCats.innerHTML = '';
    spread3.innerHTML = '';
    dayPhases.innerHTML = '';
    oneMin.textContent = '';
    linkRow.innerHTML = '';
    btnShare.hidden = true;
    scrollTop();
  });

  // ì„¤ëª… ê°•í™”
  mountToolInfo('horoscope');
</script>

<script type="module">
  import { renderCoupangBanner } from '/assets/js/ads-coupang.js';
  const slot = document.getElementById('ad-coupang');
  const tryAd = () => { 
    if(!slot || slot.dataset.loaded) return;
    renderCoupangBanner('#ad-coupang', { id: '909422', trackingCode: 'AF3778137', width:680, height:140 });
    slot.dataset.loaded = '1';
  };
  const rc = document.getElementById('resultCard');
  if (rc) {
    const obs = new MutationObserver(() => {
      if (!rc.classList.contains('hidden')) tryAd();
    });
    obs.observe(rc, { attributes:true, attributeFilter:['class'] });
  } else {
    // if there is no resultCard, just render immediately
    tryAd();
  }
</script>
<script src="/assets/js/ui-kit.js"></script>
  
</body>
</html>
